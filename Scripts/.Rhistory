devtools::install_github("cellgeni/schard")
h5ad_files_update <- list.files('~/ShinyServer/FlyCellAtlas-SES/Data/', pattern = '_new.h5ad', recursive = TRUE)
h5ad_files_update
library(qs2)
library(schard)
library(qs2)
library(schard)
h5ad_files_updated <- list.files('~/ShinyServer/FlyCellAtlas-SES/Data/', pattern = '_new.h5ad', recursive = TRUE)
h5ad_files_updated
library(qs2)
library(schard)
h5ad_files_updated <- list.files('~/ShinyServer/FlyCellAtlas-SES/Data/', pattern = '_new.h5ad', recursive = TRUE)
h5ad_files_updated
for (h5ad_file_updated in h5ad_files_updated) {
print(h5ad_file_updated)
new_file_name <- gsub('_new.h5ad', '.qs2', h5ad_file_updated)
cds <- h5ad2seurat(h5ad_file_updated)
qs_save(cds, file = new_file_name)
}
library(qs2)
library(schard)
data_dir <- '~/ShinyServer/FlyCellAtlas-SES/Data/'
h5ad_files_updated <- list.files(data_dir, pattern = '_new.h5ad', recursive = TRUE)
h5ad_files_updated
for (h5ad_file_updated in h5ad_files_updated) {
print(h5ad_file_updated)
new_file_name <- file.path(data_dir, gsub('_new.h5ad', '.qs2', h5ad_file_updated))
cds <- h5ad2seurat(h5ad_file_updated)
qs_save(cds, file = new_file_name)
}
file.path(data_dir, gsub('_new.h5ad', '.qs2', h5ad_file_updated))
library(qs2)
library(schard)
data_dir <- '~/ShinyServer/FlyCellAtlas-SES/Data/'
h5ad_files_updated <- list.files(data_dir, pattern = '_new.h5ad', recursive = TRUE, full.names = TRUE)
h5ad_files_updated
for (h5ad_file_updated in h5ad_files_updated) {
print(h5ad_file_updated)
new_file_name <- gsub('_new.h5ad', '.qs2', h5ad_file_updated)
cds <- h5ad2seurat(h5ad_file_updated)
qs_save(cds, file = new_file_name)
}
h5ad_file_updated
cds <- h5ad2seurat(h5ad_file_updated)
debug(h5ad2seurat)
cds <- h5ad2seurat(h5ad_file_updated)
scaled
data$X[1:5,1:5]
cds <- h5ad2seurat(h5ad_file_updated)
scaled
counts = data$X
counts[1:5,1:5]
rownames(counts)
tail(rownames(counts))
counts = CreateAssayObject(counts = data$X)
any(rownames(counts) == '')
table(rownames(counts) == '')
?CreateAssayObject
counts[rownames(counts) == '',]
sum(counts[rownames(counts) == '',])
undebug(h5ad2seurat)
edit(h5ad2seurat)
cds <- h5ad2seurat(h5ad_file_updated)
edit(h5ad2seurat)
h5ad2seurat <- edit(h5ad2seurat)
cds <- h5ad2seurat(h5ad_file_updated)
cds
for (h5ad_file_updated in h5ad_files_updated) {
print(h5ad_file_updated)
new_file_name <- gsub('_new.h5ad', '.qs2', h5ad_file_updated)
if (file.exists(new_file_name)) {
print('escaped!')
}else{
cds <- h5ad2seurat(h5ad_file_updated)
qs_save(cds, file = new_file_name)
}
}
